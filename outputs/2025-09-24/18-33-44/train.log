[2025-09-24 18:33:44,138][__main__][INFO] - All artifacts will be saved to: /Users/msingh361/Uber/Projects/Personal_projects/Vision Transformers (ViT) from scratch/outputs/2025-09-24/18-33-44
[2025-09-24 18:33:44,138][__main__][INFO] - --- Configuration ---
[2025-09-24 18:33:44,139][__main__][INFO] - 
model:
  in_channels: 3
  image_size: 224
  patch_size: 16
  number_of_encoder: 6
  embedding_dims: 256
  d_ff_scale_factor: 4
  heads: 8
  input_dropout_rate: 0.1
  attention_dropout_rate: 0.1
  feed_forward_dropout_rate: 0.1
  number_of_classes: 4
train:
  batch_size: 32
  epochs: 10
  train_dataset_path: dataset_path/tom_and_jerry/subset/train
  test_dataset_path: dataset_path/tom_and_jerry/subset/test

[2025-09-24 18:33:44,139][__main__][INFO] - ---------------------
[2025-09-24 18:33:44,139][__main__][INFO] - Dataset Creation Begin
[2025-09-24 18:33:44,141][__main__][INFO] -  Dataset Created 
[2025-09-24 18:33:44,141][__main__][INFO] - Dataset Classes and Corresponding Labels : {'tom': 0, 'neither_tom_nor_jerry': 1, 'jerry': 2, 'both_tom_and_jerry': 3}
[2025-09-24 18:33:44,141][__main__][INFO] - Verifying consistency between config and dataset...
[2025-09-24 18:33:44,141][__main__][INFO] - ✅ Verification successful.
[2025-09-24 18:33:44,141][__main__][INFO] - Model Creation Begin
[2025-09-24 18:33:44,278][__main__][INFO] - Model Creation Completed.
[2025-09-24 18:33:44,278][__main__][INFO] - --- Model Summary ---
[2025-09-24 18:33:44,431][__main__][INFO] - ===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
VisionTransformer                             [32, 4]                   --
├─ViTInputLayer: 1-1                          [32, 197, 256]            50,688
│    └─PatchCreation: 2-1                     [32, 196, 256]            --
│    │    └─Conv2d: 3-1                       [32, 256, 14, 14]         196,864
│    └─Dropout: 2-2                           [32, 197, 256]            --
├─Encoder: 1-2                                [32, 197, 256]            --
│    └─ModuleList: 2-3                        --                        --
│    │    └─EncoderBlock: 3-2                 [32, 197, 256]            789,760
│    │    └─EncoderBlock: 3-3                 [32, 197, 256]            789,760
│    │    └─EncoderBlock: 3-4                 [32, 197, 256]            789,760
│    │    └─EncoderBlock: 3-5                 [32, 197, 256]            789,760
│    │    └─EncoderBlock: 3-6                 [32, 197, 256]            789,760
│    │    └─EncoderBlock: 3-7                 [32, 197, 256]            789,760
├─Sequential: 1-3                             [32, 4]                   --
│    └─LayerNorm: 2-4                         [32, 256]                 512
│    └─Linear: 2-5                            [32, 4]                   1,028
===============================================================================================
Total params: 4,987,652
Trainable params: 4,987,652
Non-trainable params: 0
Total mult-adds (G): 1.39
===============================================================================================
Input size (MB): 19.27
Forward/backward pass size (MB): 865.01
Params size (MB): 19.75
Estimated Total Size (MB): 904.03
===============================================================================================
[2025-09-24 18:33:44,432][__main__][INFO] - --------------------
[2025-09-24 18:33:44,432][__main__][INFO] - MODEL TRAINING BEGINS...
[2025-09-24 18:33:48,752][__main__][INFO] - Epoch 1 | train_loss: 1.4356 | train_accuracy: 0.2656 | val_loss: 1.5603 | val_accuracy: 0.1562 | LR: 0.000133
[2025-09-24 18:33:52,448][__main__][INFO] - Epoch 2 | train_loss: 1.4357 | train_accuracy: 0.3021 | val_loss: 1.6154 | val_accuracy: 0.1562 | LR: 0.000267
[2025-09-24 18:33:56,180][__main__][INFO] - Epoch 3 | train_loss: 1.4752 | train_accuracy: 0.2656 | val_loss: 1.7156 | val_accuracy: 0.1562 | LR: 0.000293
[2025-09-24 18:33:59,896][__main__][INFO] - Epoch 4 | train_loss: 1.4166 | train_accuracy: 0.3281 | val_loss: 1.2781 | val_accuracy: 0.5312 | LR: 0.000264
[2025-09-24 18:34:03,615][__main__][INFO] - Epoch 5 | train_loss: 1.4011 | train_accuracy: 0.2865 | val_loss: 1.3077 | val_accuracy: 0.4219 | LR: 0.000216
[2025-09-24 18:34:07,333][__main__][INFO] - Epoch 6 | train_loss: 1.4085 | train_accuracy: 0.2995 | val_loss: 1.5500 | val_accuracy: 0.1406 | LR: 0.000158
[2025-09-24 18:34:11,099][__main__][INFO] - Epoch 7 | train_loss: 1.3818 | train_accuracy: 0.2969 | val_loss: 1.2890 | val_accuracy: 0.4688 | LR: 0.000098
[2025-09-24 18:34:14,833][__main__][INFO] - Epoch 8 | train_loss: 1.3948 | train_accuracy: 0.3047 | val_loss: 1.2699 | val_accuracy: 0.5312 | LR: 0.000047
[2025-09-24 18:34:18,568][__main__][INFO] - Epoch 9 | train_loss: 1.3618 | train_accuracy: 0.3516 | val_loss: 1.3104 | val_accuracy: 0.4688 | LR: 0.000012
[2025-09-24 18:34:22,266][__main__][INFO] - Epoch 10 | train_loss: 1.3626 | train_accuracy: 0.3594 | val_loss: 1.3016 | val_accuracy: 0.4688 | LR: 0.000000
